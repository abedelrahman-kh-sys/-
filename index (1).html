<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± - Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡</title>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
<style>
:root{--bg:#0b1929;--bg2:#132744;--card:rgba(20,36,58,0.92);--border:#1e3654;--accent:#d4a853;--accentG:#ebd08a;--g:#27c96e;--r:#e74c3c;--o:#f0a030;--blue:#3498db;--tw:#e8edf2;--tm:#8ba3be;--td:#4e6d8a}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,sans-serif;background:linear-gradient(160deg,var(--bg),var(--bg2) 50%,#0e1e35);color:var(--tw);min-height:100vh;direction:rtl}
button{font-family:inherit;cursor:pointer;border:none;transition:all .25s ease}
input,select{font-family:inherit;outline:none;transition:all .2s ease}
input:focus{border-color:var(--accent)!important;box-shadow:0 0 0 3px rgba(212,168,83,.18)}
.page{display:none;min-height:100vh}.page.active{display:block}
.hdr{background:rgba(12,24,44,.96);border-bottom:2px solid var(--accent);padding:14px 20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
.hdr-t{font-size:1.1rem;font-weight:800}.hdr-s{font-size:.72rem;color:var(--accent);font-weight:600}
.hdr-btns{display:flex;gap:8px;align-items:center}
.btn-back{background:rgba(212,168,83,.12);border:1px solid rgba(212,168,83,.3);border-radius:8px;padding:8px 16px;color:var(--accent);font-weight:700;font-size:.78rem}
.btn-refresh{background:rgba(39,201,110,.12);border:1px solid rgba(39,201,110,.3);border-radius:8px;padding:8px 14px;color:var(--g);font-weight:700;font-size:.76rem}
.ctr{max-width:480px;margin:0 auto;padding:28px 20px}
.ctr-wide{max-width:960px;margin:0 auto;padding:20px 16px}
.avatar{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accentG));display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:900;color:#0b1929;box-shadow:0 6px 30px rgba(212,168,83,.3);margin:0 auto 20px}
.avatar-sm{width:72px;height:72px;font-size:1.8rem;margin:0 auto 14px}
.clock-box{text-align:center;padding:14px;background:rgba(15,25,42,.6);border-radius:12px;border:1px solid var(--border);margin-bottom:20px}
.clock-lbl{font-size:.65rem;color:var(--td);letter-spacing:3px;margin-bottom:4px}
.clock-time{font-size:2.2rem;font-weight:900;font-family:'Courier New',monospace;letter-spacing:4px;direction:ltr}
.card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:24px}
.pin-wrap{display:flex;justify-content:center;gap:12px;direction:ltr}
.pin-inp{width:56px;height:64px;text-align:center;font-size:1.6rem;font-weight:800;background:rgba(15,25,42,.8);border:2px solid var(--border);border-radius:14px;color:var(--tw);font-family:'Courier New',monospace}
.pin-inp.filled{background:rgba(212,168,83,.12);border-color:var(--accent)}
.pin-err{margin-top:12px;color:var(--r);font-size:.82rem;font-weight:700;text-align:center}
.btn-big{width:100%;padding:18px;border-radius:14px;font-size:1.15rem;font-weight:800;color:#fff}
.btn-checkin{background:linear-gradient(135deg,var(--g),#20a85a);box-shadow:0 4px 22px rgba(39,201,110,.3)}
.btn-checkout{background:linear-gradient(135deg,var(--r),#c0392b);box-shadow:0 4px 22px rgba(231,76,60,.3)}
.btn-disabled{background:#2a3d52!important;color:#5a6a7a!important;cursor:not-allowed!important;box-shadow:none!important}
.btn-admin{background:linear-gradient(135deg,var(--accent),var(--accentG));color:#0b1929;box-shadow:0 4px 25px rgba(212,168,83,.28)}
.btn-worker{padding:13px 18px;background:var(--card);border:1px solid var(--border);border-radius:12px;color:var(--tw);font-size:.95rem;font-weight:700;display:flex;align-items:center;gap:12px;width:100%}
.btn-worker:hover{border-color:var(--accent);background:rgba(212,168,83,.06)}
.btn-worker .av{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#1a3a5c,#2a5580);display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:800;color:var(--accent);flex-shrink:0}
.proj-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:20px}
.proj-btn{padding:12px 10px;background:var(--card);border:1.5px solid var(--border);border-radius:10px;color:var(--tm);font-size:.82rem;font-weight:700;text-align:center}
.proj-btn.sel{background:rgba(212,168,83,.15);border-color:var(--accent);color:var(--accent)}
.info-row{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-radius:12px;margin-bottom:12px}
.info-row.green{background:rgba(39,201,110,.08);border:1px solid rgba(39,201,110,.2)}
.info-row.gold{background:rgba(212,168,83,.08);border:1px solid rgba(212,168,83,.2)}
.stats-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.stat-box{border-radius:10px;padding:12px;text-align:center}
.stat-lbl{font-size:.68rem;color:var(--td);margin-bottom:3px}
.stat-val{font-size:.95rem;font-weight:800;font-family:monospace}
.sum-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:18px}
.sum-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 10px;text-align:center}
.sum-val{font-size:1.4rem;font-weight:900}
.sum-lbl{font-size:.6rem;color:var(--td);font-weight:600}
.tabs{display:flex;border-bottom:1px solid var(--border);margin-bottom:18px;overflow-x:auto}
.tab-btn{padding:10px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--td);font-weight:700;font-size:.78rem;white-space:nowrap}
.tab-btn.active{background:rgba(212,168,83,.12);border-bottom-color:var(--accent);color:var(--accent)}
.tbl-wrap{background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:22px}
.tbl-head{background:linear-gradient(135deg,#1a3a5c,#2a5580);padding:12px 18px;border-bottom:2px solid var(--accent)}
.tbl-head h3{color:var(--accent);font-size:.9rem;font-weight:700;margin:0}
table{width:100%;border-collapse:collapse}
th{padding:10px 10px;text-align:right;font-size:.66rem;color:var(--td);font-weight:700;border-bottom:1px solid var(--border);white-space:nowrap;background:rgba(26,58,92,.35)}
td{padding:10px 10px;font-size:.8rem;border-bottom:1px solid rgba(30,54,84,.15)}
.mono{font-family:monospace;font-weight:600}
.badge{padding:3px 10px;border-radius:18px;font-size:.7rem;font-weight:700;display:inline-block}
.wtabs{display:flex;border-bottom:1px solid var(--border);overflow-x:auto}
.wtab{padding:10px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--td);font-weight:700;font-size:.8rem;white-space:nowrap}
.wtab.active{background:rgba(212,168,83,.12);border-bottom-color:var(--accent);color:var(--accent)}
.manage-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:20px;margin-bottom:18px}
.manage-card h3{color:var(--accent);font-size:.9rem;font-weight:700;margin-bottom:16px}
.manage-row{display:flex;align-items:center;gap:10px;padding:10px 14px;background:rgba(15,25,42,.6);border-radius:10px;margin-bottom:8px;flex-wrap:wrap}
.manage-input{padding:10px 14px;background:rgba(15,25,42,.8);border:1px solid var(--border);border-radius:10px;color:var(--tw);font-size:.85rem;width:100%}
.btn-sm{padding:4px 10px;border-radius:6px;font-size:.7rem;font-weight:700}
.btn-add{padding:10px 16px;background:linear-gradient(135deg,var(--g),#20a85a);border-radius:10px;color:#fff;font-weight:700;white-space:nowrap}
.modal-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:999;padding:20px}
.modal{background:#132744;border:1px solid var(--border);border-radius:16px;padding:24px;width:380px;max-width:100%}
.modal h3{color:var(--accent);font-size:.95rem;font-weight:700;margin-bottom:16px}
.tag-btns{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:14px}
.tag-btn{padding:6px 14px;background:rgba(15,25,42,.8);border:1px solid var(--border);border-radius:8px;color:var(--tm);font-size:.78rem;font-weight:600}
.tag-btn.sel{background:rgba(212,168,83,.2);border-color:var(--accent);color:var(--accent)}
.toast{background:rgba(39,201,110,.14);border:1px solid rgba(39,201,110,.35);border-radius:12px;padding:12px 18px;margin-bottom:18px;text-align:center;color:var(--g);font-weight:700;font-size:.9rem;animation:fadeUp .3s ease}
.toast-err{background:rgba(231,76,60,.12);border:1px solid rgba(231,76,60,.3);color:var(--r)}
.loading-spinner{text-align:center;padding:40px;color:var(--td);font-size:1rem}
@keyframes fadeUp{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
@keyframes shakeX{0%,100%{transform:translateX(0)}20%{transform:translateX(-12px)}40%{transform:translateX(12px)}60%{transform:translateX(-8px)}80%{transform:translateX(8px)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
.shake{animation:shakeX .5s ease}.fadeUp{animation:fadeUp .4s ease}.pulse{animation:pulse 2s infinite}
@media(max-width:500px){.sum-grid{grid-template-columns:repeat(2,1fr)}.proj-grid{grid-template-columns:1fr}}
::-webkit-scrollbar{height:4px;width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}
</style>
</head>
<body>

<!-- SITE PASSWORD PAGE -->
<div id="page-lock" class="page active">
  <div style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px">
    <img src="data:image/png;base64,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" style="width:100px;height:auto;border-radius:16px;box-shadow:0 8px 35px rgba(212,168,83,.28);margin-bottom:18px">
    <h1 style="font-size:1.5rem;font-weight:800;margin-bottom:3px">Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</h1>
    <p style="color:var(--accent);font-size:.82rem;font-weight:600;margin-bottom:6px">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</p>
    <p style="color:var(--td);font-size:.75rem;margin-bottom:32px">ğŸ”’ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø­Ù…ÙŠ Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±</p>
    <div class="card" style="border-radius:18px;padding:32px 24px;width:340px;max-width:100%;text-align:center">
      <div style="font-size:1.4rem;margin-bottom:16px">ğŸ”‘</div>
      <div style="font-size:.8rem;color:var(--tm);margin-bottom:16px;font-weight:600">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø¯Ø®ÙˆÙ„</div>
      <input type="password" id="site-pass" class="manage-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="text-align:center;font-size:1.1rem;margin-bottom:14px;direction:ltr" onkeydown="if(event.key==='Enter')checkSitePass()">
      <button class="btn-big btn-admin" style="font-size:1rem" onclick="checkSitePass()">ğŸ”“ Ø¯Ø®ÙˆÙ„</button>
      <div id="site-pass-err" style="display:none;margin-top:12px;color:var(--r);font-size:.82rem;font-weight:700"></div>
    </div>
  </div>
</div>

<!-- HOME PAGE -->
<div id="page-home" class="page">
  <div style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px">
    <img src="data:image/png;base64,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" style="width:100px;height:auto;border-radius:16px;box-shadow:0 8px 35px rgba(212,168,83,.28);margin-bottom:18px">
    <h1 style="font-size:1.5rem;font-weight:800;margin-bottom:3px">Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</h1>
    <p style="color:var(--accent);font-size:.82rem;font-weight:600;margin-bottom:32px">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</p>
    <button class="btn-big btn-admin" style="width:300px;max-width:100%;margin-bottom:14px;font-size:1.05rem" onclick="showPage('admin-pin')">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø§Ù„Ù…Ø¯ÙŠØ±)</button>
    <div style="color:var(--td);font-size:.78rem;margin-bottom:14px;font-weight:600">â€” ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± â€”</div>
    <div id="home-workers" style="display:flex;flex-direction:column;gap:8px;width:300px;max-width:100%"></div>
  </div>
</div>

<!-- WORKER PIN -->
<div id="page-worker-pin" class="page">
  <div class="hdr"><div><div class="hdr-t">Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</div><div class="hdr-s">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</div></div><div class="hdr-btns"><button class="btn-back" onclick="showPage('home')">â† Ø±Ø¬ÙˆØ¹</button></div></div>
  <div class="ctr" style="padding-top:50px;text-align:center">
    <div class="avatar" id="wp-avatar"></div>
    <h2 style="font-size:1.4rem;font-weight:800;margin-bottom:6px" id="wp-name"></h2>
    <p style="color:var(--td);font-size:.8rem;margin-bottom:36px">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
    <div class="card" style="border-radius:18px;padding:32px 24px">
      <div style="font-size:1.4rem;margin-bottom:20px">ğŸ”</div>
      <div style="font-size:.8rem;color:var(--tm);margin-bottom:16px;font-weight:600" id="wp-pin-label">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ (4 Ø£Ø±Ù‚Ø§Ù…)</div>
      <div class="pin-wrap" id="wp-pin-wrap"></div>
      <div class="pin-err" id="wp-pin-err" style="display:none"></div>
    </div>
  </div>
</div>

<!-- WORKER MAIN -->
<div id="page-worker" class="page">
  <div class="hdr"><div><div class="hdr-t">Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</div><div class="hdr-s">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</div></div><div class="hdr-btns"><button class="btn-back" onclick="workerLogout()">â† Ø±Ø¬ÙˆØ¹</button></div></div>
  <div class="ctr">
    <div style="text-align:center;margin-bottom:24px">
      <div class="avatar avatar-sm" id="w-avatar"></div>
      <h2 style="font-size:1.3rem;font-weight:800;margin:0" id="w-name"></h2>
      <p style="color:var(--td);font-size:.8rem;margin-top:4px" id="w-date"></p>
    </div>
    <div class="clock-box"><div class="clock-lbl">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ</div><div class="clock-time" id="w-clock"></div></div>
    <div id="w-toast"></div>
    <div id="w-error"></div>
    <div class="card fadeUp" id="w-content"><div class="loading-spinner">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div>
  </div>
</div>

<!-- ADMIN PIN -->
<div id="page-admin-pin" class="page">
  <div class="hdr"><div><div class="hdr-t">Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</div><div class="hdr-s">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</div></div><div class="hdr-btns"><button class="btn-back" onclick="showPage('home')">â† Ø±Ø¬ÙˆØ¹</button></div></div>
  <div class="ctr" style="padding-top:60px;text-align:center">
    <div style="font-size:3rem;margin-bottom:16px">ğŸ“Š</div>
    <h2 style="font-size:1.3rem;font-weight:800;margin-bottom:6px">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
    <p style="color:var(--td);font-size:.8rem;margin-bottom:36px">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù…Ø¯ÙŠØ±</p>
    <div class="card" style="border-radius:18px;padding:32px 24px">
      <div class="pin-wrap" id="ap-pin-wrap"></div>
      <div class="pin-err" id="ap-pin-err" style="display:none"></div>
    </div>
  </div>
</div>

<!-- ADMIN DASHBOARD -->
<div id="page-admin" class="page">
  <div class="hdr">
    <div><div class="hdr-t">ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø­Ø¶ÙˆØ±</div><div class="hdr-s" id="admin-sub"></div></div>
    <div class="hdr-btns"><button class="btn-refresh" onclick="adminLoad()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button><button class="btn-back" onclick="showPage('home')">â† Ø±Ø¬ÙˆØ¹</button></div>
  </div>
  <div class="ctr-wide">
    <div class="sum-grid" id="admin-summary"></div>
    <div class="tabs" id="admin-tabs"></div>
    <div id="admin-content"></div>
  </div>
</div>

<!-- MODAL -->
<div id="modal" class="modal-bg" style="display:none" onclick="closeModal()">
  <div class="modal" onclick="event.stopPropagation()" id="modal-content"></div>
</div>

<script>
// ============================================================
// FIREBASE INIT
// ============================================================
firebase.initializeApp({
  apiKey: "AIzaSyBkeSf4uv0b3oPAeQWHn8_at8gcMmOwrHM",
  authDomain: "mashour-attendance.firebaseapp.com",
  projectId: "mashour-attendance",
  storageBucket: "mashour-attendance.firebasestorage.app",
  messagingSenderId: "351494537478",
  appId: "1:351494537478:web:c928ac25d154d9110d5e87"
});
const db = firebase.firestore();

// ============================================================
// SITE PASSWORD - ØºÙŠÙ‘Ø± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‡Ù†Ø§
// ============================================================
const SITE_PASSWORD = "mashhour2026";
const LOGO_B64 = "data:image/png;base64,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";

// ============================================================
// DEFAULT CONFIG
// ============================================================
const DEF = {
  workers:[
    {id:"muath",name:"Ù…Ø¹Ø§Ø°",pin:"1234",active:true},
    {id:"ahmad",name:"Ø£Ø­Ù…Ø¯",pin:"2345",active:true},
    {id:"khaled",name:"Ø®Ø§Ù„Ø¯",pin:"3456",active:true},
    {id:"omar",name:"Ø¹Ù…Ø±",pin:"4567",active:true},
    {id:"sami",name:"Ø³Ø§Ù…ÙŠ",pin:"5678",active:true},
  ],
  projects:[
    {id:"avital6",name:"××‘×™×˜×œ 6",active:true},
    {id:"haftzelet",name:"×—×¤×¦×œ×ª",active:true},
    {id:"hala15",name:'×”×œ"×” 15',active:true},
    {id:"eden",name:"××ª×—× ×¢×“×Ÿ",active:true},
    {id:"un",name:"UN",active:true},
    {id:"office",name:"××©×¨×“ ××—×™× ××©×”×•×¨",active:true},
    {id:"court",name:"×‘×™×ª ××©×¤×˜",active:true},
  ],
  adminPin:"0000",
  companyName:"Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©"
};

// ============================================================
// STATE
// ============================================================
let CFG=null, curW=null, curRec=null, selProj=null, wAttempts=0, aTab="today", mWorker=null, clockInt=null;

// ============================================================
// FIREBASE HELPERS
// ============================================================
async function loadCfg(){
  try{const d=await db.collection("config").doc("main").get();if(d.exists)return d.data();} catch(e){console.log("cfg err",e);}
  return null;
}
async function saveCfg(){
  try{await db.collection("config").doc("main").set(CFG);} catch(e){console.log("save cfg err",e);}
}
async function getAtt(wid,date){
  try{const d=await db.collection("attendance").doc(`${wid}_${date}`).get();return d.exists?d.data():null;} catch{return null;}
}
async function setAtt(wid,date,rec){
  try{await db.collection("attendance").doc(`${wid}_${date}`).set(rec);} catch(e){console.log("set att err",e);}
}
async function delAtt(wid,date){
  try{await db.collection("attendance").doc(`${wid}_${date}`).delete();} catch(e){console.log("del err",e);}
}
async function getAllAtt(wid){
  const recs={};
  try{
    const q=await db.collection("attendance").where("workerId","==",wid).get();
    q.forEach(d=>{const r=d.data();recs[r.date]=r;});
  }catch(e){console.log("getAll err",e);}
  return recs;
}
async function getAllWorkersTodayAtt(today){
  const recs={};
  try{
    const q=await db.collection("attendance").where("date","==",today).get();
    q.forEach(d=>{const r=d.data();recs[r.workerId]=r;});
  }catch(e){console.log("getAllToday err",e);}
  return recs;
}
async function getAllFlagged(){
  const f=[];
  try{
    const q=await db.collection("attendance").where("flag","!=",null).get();
    q.forEach(d=>{const r=d.data();if(r.flag)f.push(r);});
  }catch(e){console.log("flagged err",e);}
  f.sort((a,b)=>b.date.localeCompare(a.date));
  return f;
}

// ============================================================
// HELPERS
// ============================================================
function getToday(){const d=new Date();return`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;}
function fmtTime(iso){return iso?new Date(iso).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit",hour12:false}):"â€”";}
function fmtDate(s){return new Date(s+"T00:00:00").toLocaleDateString("ar-EG",{weekday:"short",day:"numeric",month:"short"});}
function fmtFull(){return new Date().toLocaleDateString("ar-EG",{weekday:"long",day:"numeric",month:"long",year:"numeric"});}
function calcH(a,b){return(!a||!b)?"â€”":((new Date(b)-new Date(a))/36e5).toFixed(1);}
function mDays(){const n=new Date(),y=n.getFullYear(),m=n.getMonth(),d=[];for(let i=1;i<=new Date(y,m+1,0).getDate();i++)d.push(`${y}-${String(m+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`);return d;}
function mName(){return new Date().toLocaleDateString("ar-EG",{month:"long",year:"numeric"});}
function gid(){return Math.random().toString(36).substr(2,8);}
function esc(s){const d=document.createElement("div");d.textContent=s;return d.innerHTML;}

// ============================================================
// SITE PASSWORD
// ============================================================
function checkSitePass(){
  const v=document.getElementById("site-pass").value;
  if(v===SITE_PASSWORD){showPage("home");}
  else{const e=document.getElementById("site-pass-err");e.textContent="âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";e.style.display="block";document.getElementById("site-pass").value="";}
}

// ============================================================
// PAGE NAV
// ============================================================
function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById("page-"+id).classList.add("active");
  if(id==="home")renderHome();
  if(id==="worker-pin")renderWorkerPin();
  if(id==="admin-pin")renderAdminPin();
  if(id==="admin"){aTab="today";adminLoad();}
}

// ============================================================
// HOME
// ============================================================
function renderHome(){
  const c=document.getElementById("home-workers");c.innerHTML="";
  CFG.workers.filter(w=>w.active).forEach(w=>{
    const b=document.createElement("button");b.className="btn-worker";
    b.innerHTML=`<span class="av">${esc(w.name[0])}</span>${esc(w.name)}<span style="margin-right:auto;font-size:.7rem;color:var(--td)">ğŸ”</span>`;
    b.onclick=()=>{curW=w;wAttempts=0;showPage("worker-pin");};
    c.appendChild(b);
  });
}

// ============================================================
// PIN INPUT
// ============================================================
function makePin(cid,eid,cb){
  const c=document.getElementById(cid);c.innerHTML="";const ins=[];
  for(let i=0;i<4;i++){
    const inp=document.createElement("input");inp.type="tel";inp.inputMode="numeric";inp.maxLength=1;inp.className="pin-inp";
    inp.addEventListener("input",function(){if(!/^\d$/.test(this.value)){this.value="";return;}this.classList.add("filled");if(i<3)ins[i+1].focus();if(ins.every(x=>x.value))setTimeout(()=>cb(ins.map(x=>x.value).join("")),150);});
    inp.addEventListener("keydown",function(e){if(e.key==="Backspace"&&!this.value&&i>0){ins[i-1].focus();ins[i-1].value="";ins[i-1].classList.remove("filled");}});
    inp.addEventListener("focus",function(){this.select();});
    ins.push(inp);c.appendChild(inp);
  }
  document.getElementById(eid).style.display="none";
  setTimeout(()=>ins[0].focus(),100);
}
function pinErr(eid,wid,msg){
  document.getElementById(eid).textContent="âš ï¸ "+msg;document.getElementById(eid).style.display="block";
  const w=document.getElementById(wid);w.classList.add("shake");
  setTimeout(()=>{w.classList.remove("shake");w.querySelectorAll("input").forEach(i=>{i.value="";i.classList.remove("filled");});w.querySelector("input").focus();},600);
}

// ============================================================
// WORKER PIN
// ============================================================
function renderWorkerPin(){
  document.getElementById("wp-avatar").textContent=curW.name[0];
  document.getElementById("wp-name").textContent="Ù…Ø±Ø­Ø¨Ø§Ù‹ "+curW.name;
  document.getElementById("wp-pin-label").textContent="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ (4 Ø£Ø±Ù‚Ø§Ù…)";
  makePin("wp-pin-wrap","wp-pin-err",function(pin){
    if(pin===curW.pin){showPage("worker");renderWorker();}
    else{wAttempts++;if(wAttempts>=3){pinErr("wp-pin-err","wp-pin-wrap","ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ - ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ±");document.getElementById("wp-pin-label").textContent="";}else pinErr("wp-pin-err","wp-pin-wrap",`Ø±Ù…Ø² Ø®Ø§Ø·Ø¦ (${3-wAttempts} Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©)`);}
  });
}

// ============================================================
// WORKER MAIN
// ============================================================
function renderWorker(){
  document.getElementById("w-avatar").textContent=curW.name[0];
  document.getElementById("w-name").textContent=curW.name;
  document.getElementById("w-date").textContent=fmtFull();
  selProj=null;startClock();loadWStatus();
}
function startClock(){if(clockInt)clearInterval(clockInt);function t(){const e=document.getElementById("w-clock");if(e)e.textContent=new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:false});}t();clockInt=setInterval(t,1000);}
function workerLogout(){curW=null;if(clockInt)clearInterval(clockInt);showPage("home");}

async function loadWStatus(){
  const c=document.getElementById("w-content");
  c.innerHTML='<div class="loading-spinner">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  document.getElementById("w-toast").innerHTML="";document.getElementById("w-error").innerHTML="";
  const today=getToday();
  curRec=await getAtt(curW.id,today);
  if(!curRec){
    const projs=CFG.projects.filter(p=>p.active);
    c.innerHTML=`<div style="text-align:center;margin-bottom:16px"><div style="font-size:3rem;margin-bottom:8px" class="pulse">ğŸ‘‹</div><div style="font-size:.85rem;color:var(--td);font-weight:600">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØ³Ø¬Ù‘Ù„ ÙˆØµÙˆÙ„Ùƒ</div></div>
    <div style="font-size:.75rem;color:var(--tm);margin-bottom:10px;font-weight:700">ğŸ“ Ø§Ø®ØªØ± Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…:</div>
    <div class="proj-grid" id="w-projs"></div>
    <button class="btn-big btn-disabled" id="w-ci-btn" onclick="doCI()" disabled>â¬†ï¸ Ø§Ø®ØªØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø£ÙˆÙ„Ø§Ù‹</button>`;
    const pg=document.getElementById("w-projs");
    projs.forEach(p=>{const b=document.createElement("button");b.className="proj-btn";b.textContent=p.name;b.onclick=()=>{selProj=p;pg.querySelectorAll(".proj-btn").forEach(x=>x.classList.remove("sel"));b.classList.add("sel");b.textContent="âœ… "+p.name;const btn=document.getElementById("w-ci-btn");btn.disabled=false;btn.className="btn-big btn-checkin";btn.textContent="âœ… ØªØ³Ø¬ÙŠÙ„ ÙˆØµÙˆÙ„";};pg.appendChild(b);});
  }else if(curRec.checkIn&&!curRec.checkOut){
    c.innerHTML=`<div class="info-row green"><span style="color:var(--tm);font-size:.85rem;font-weight:600">â° ÙˆÙ‚Øª Ø§Ù„ÙˆØµÙˆÙ„</span><span style="color:var(--g);font-size:1.15rem;font-weight:800;font-family:monospace">${fmtTime(curRec.checkIn)}</span></div>
    <div class="info-row gold" style="justify-content:center"><span style="font-size:.75rem;color:var(--td)">ğŸ“ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: </span><span style="font-size:.88rem;color:var(--accent);font-weight:700">${esc(curRec.projectName||"â€”")}</span></div>
    ${curRec.checkInLoc?`<div style="font-size:.72rem;color:var(--td);margin:12px 0;text-align:center">ğŸ“ ${curRec.checkInLoc.lat.toFixed(5)}, ${curRec.checkInLoc.lng.toFixed(5)}</div>`:""}
    <button class="btn-big btn-checkout" onclick="doCO()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ù…ØºØ§Ø¯Ø±Ø©</button>`;
  }else{
    const r=curRec;
    c.innerHTML=`<div style="text-align:center;margin-bottom:16px"><div style="font-size:2.8rem;margin-bottom:8px">âœ…</div><div style="color:var(--g);font-weight:800;font-size:1.05rem">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</div></div>
    <div style="text-align:center;margin-bottom:16px"><span style="background:rgba(212,168,83,.1);border:1px solid rgba(212,168,83,.25);border-radius:20px;padding:4px 14px;font-size:.78rem;color:var(--accent);font-weight:700">ğŸ“ ${esc(r.projectName||"â€”")}</span></div>
    <div class="stats-3">
      <div class="stat-box" style="background:rgba(39,201,110,.07);border:1px solid rgba(39,201,110,.2)"><div class="stat-lbl">ÙˆØµÙˆÙ„</div><div class="stat-val" style="color:var(--g)">${fmtTime(r.checkIn)}</div></div>
      <div class="stat-box" style="background:rgba(231,76,60,.07);border:1px solid rgba(231,76,60,.2)"><div class="stat-lbl">Ù…ØºØ§Ø¯Ø±Ø©</div><div class="stat-val" style="color:var(--r)">${fmtTime(r.checkOut)}</div></div>
      <div class="stat-box" style="background:rgba(212,168,83,.07);border:1px solid rgba(212,168,83,.2)"><div class="stat-lbl">Ø³Ø§Ø¹Ø§Øª</div><div class="stat-val" style="color:var(--accent)">${calcH(r.checkIn,r.checkOut)}</div></div>
    </div>
    ${r.checkInLoc?`<div style="margin-top:14px;padding:10px 14px;background:rgba(20,36,58,.5);border-radius:10px;font-size:.7rem;color:var(--td)">ğŸ“ ÙˆØµÙˆÙ„: <a href="https://maps.google.com/?q=${r.checkInLoc.lat},${r.checkInLoc.lng}" target="_blank" style="color:var(--blue)">Ø®Ø±ÙŠØ·Ø©</a>${r.checkOutLoc?` Â· ğŸ“ Ù…ØºØ§Ø¯Ø±Ø©: <a href="https://maps.google.com/?q=${r.checkOutLoc.lat},${r.checkOutLoc.lng}" target="_blank" style="color:var(--blue)">Ø®Ø±ÙŠØ·Ø©</a>`:""}</div>`:""}`;
  }
}

function wToast(m){document.getElementById("w-toast").innerHTML=`<div class="toast">${m}</div>`;setTimeout(()=>{document.getElementById("w-toast").innerHTML="";},3000);}
function wErr(m){document.getElementById("w-error").innerHTML=`<div class="toast toast-err">âš ï¸ ${m}</div>`;}

function getLoc(){return new Promise((res,rej)=>{if(!navigator.geolocation)return rej("GPS ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…");navigator.geolocation.getCurrentPosition(p=>res({lat:p.coords.latitude,lng:p.coords.longitude,acc:Math.round(p.coords.accuracy)}),()=>rej("ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ GPS"),{enableHighAccuracy:true,timeout:15000,maximumAge:0});});}

async function doCI(){
  if(!selProj){wErr("Ø§Ø®ØªØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø£ÙˆÙ„Ø§Ù‹");return;}
  const btn=document.getElementById("w-ci-btn");btn.disabled=true;btn.textContent="â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„...";btn.className="btn-big btn-disabled";
  document.getElementById("w-error").innerHTML="";
  try{
    const loc=await getLoc();const now=new Date().toISOString();const today=getToday();
    const rec={workerId:curW.id,workerName:curW.name,date:today,projectId:selProj.id,projectName:selProj.name,checkIn:now,checkInLoc:loc,checkOut:null,checkOutLoc:null,flag:null};
    await setAtt(curW.id,today,rec);curRec=rec;wToast("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…");loadWStatus();
  }catch(e){wErr(typeof e==="string"?e:"Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹");btn.disabled=false;btn.className="btn-big btn-checkin";btn.textContent="âœ… ØªØ³Ø¬ÙŠÙ„ ÙˆØµÙˆÙ„";}
}

async function doCO(){
  const btn=document.querySelector(".btn-checkout");if(btn){btn.disabled=true;btn.textContent="â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„...";}
  document.getElementById("w-error").innerHTML="";
  try{
    const loc=await getLoc();const now=new Date().toISOString();
    const rec={...curRec,checkOut:now,checkOutLoc:loc};
    await setAtt(curW.id,getToday(),rec);curRec=rec;wToast("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­ âœ…");loadWStatus();
  }catch(e){wErr(typeof e==="string"?e:"Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹");if(btn){btn.disabled=false;btn.textContent="ğŸšª ØªØ³Ø¬ÙŠÙ„ Ù…ØºØ§Ø¯Ø±Ø©";}}
}

// ============================================================
// ADMIN
// ============================================================
function renderAdminPin(){
  makePin("ap-pin-wrap","ap-pin-err",function(pin){
    if(pin===CFG.adminPin)showPage("admin");
    else pinErr("ap-pin-err","ap-pin-wrap","Ø±Ù…Ø² Ø§Ù„Ù…Ø¯ÙŠØ± ØºÙŠØ± ØµØ­ÙŠØ­");
  });
}

async function adminLoad(){
  document.getElementById("admin-sub").textContent=CFG.companyName;
  renderATabs();
  document.getElementById("admin-content").innerHTML='<div class="loading-spinner">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  await renderASummary();
  await renderAContent();
}

async function renderASummary(){
  const today=getToday();const aw=CFG.workers.filter(w=>w.active);
  const todayRecs=await getAllWorkersTodayAtt(today);
  let p=0,a=0,act=0;
  aw.forEach(w=>{const r=todayRecs[w.id];if(r?.checkOut)p++;else if(r?.checkIn){p++;act++;}else a++;});
  document.getElementById("admin-summary").innerHTML=[
    {i:"ğŸ‘¥",l:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ",v:aw.length,c:"var(--tm)"},{i:"âœ…",l:"Ø­Ø§Ø¶Ø±",v:p,c:"var(--g)"},{i:"ğŸ”µ",l:"ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹",v:act,c:"var(--o)"},{i:"âŒ",l:"ØºØ§Ø¦Ø¨",v:a,c:"var(--r)"},
  ].map(x=>`<div class="sum-card"><div style="font-size:1.1rem">${x.i}</div><div class="sum-val" style="color:${x.c}">${x.v}</div><div class="sum-lbl">${x.l}</div></div>`).join("");
  window._todayRecs=todayRecs;
}

function renderATabs(){
  const tabs=[{id:"today",i:"ğŸ“‹",l:"Ø§Ù„ÙŠÙˆÙ…"},{id:"monthly",i:"ğŸ“…",l:"Ø´Ù‡Ø±ÙŠ"},{id:"manage",i:"âš™ï¸",l:"Ø¥Ø¯Ø§Ø±Ø©"},{id:"archive",i:"ğŸ—„ï¸",l:"Ø£Ø±Ø´ÙŠÙ"}];
  document.getElementById("admin-tabs").innerHTML=tabs.map(t=>`<button class="tab-btn ${aTab===t.id?"active":""}" onclick="aTab='${t.id}';renderATabs();renderAContent();">${t.i} ${t.l}</button>`).join("");
}

async function renderAContent(){
  const c=document.getElementById("admin-content");
  c.innerHTML='<div class="loading-spinner">â³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  if(aTab==="today")await rToday(c);
  else if(aTab==="monthly")await rMonthly(c);
  else if(aTab==="manage")rManage(c);
  else if(aTab==="archive")await rArchive(c);
}

async function rToday(c){
  const today=getToday();const aw=CFG.workers.filter(w=>w.active);
  const recs=window._todayRecs||await getAllWorkersTodayAtt(today);
  let rows="";
  aw.forEach(w=>{
    const r=recs[w.id];const st=r?.checkOut?{t:"Ø£Ù†Ù‡Ù‰",c:"var(--g)"}:r?.checkIn?{t:"Ù…ÙˆØ¬ÙˆØ¯",c:"var(--o)"}:{t:"ØºØ§Ø¦Ø¨",c:"var(--r)"};
    rows+=`<tr><td style="font-weight:700">${esc(w.name)}</td><td style="font-size:.78rem;color:var(--accent);font-weight:600">${esc(r?.projectName||"â€”")}</td><td><span class="badge" style="background:${st.c}18;color:${st.c}">${st.t}</span></td><td class="mono" style="color:var(--tm)">${fmtTime(r?.checkIn)}</td><td class="mono" style="color:var(--tm)">${fmtTime(r?.checkOut)}</td><td style="color:var(--accent);font-weight:700">${calcH(r?.checkIn,r?.checkOut)}</td><td>${r?.checkInLoc?`<a href="https://maps.google.com/?q=${r.checkInLoc.lat},${r.checkInLoc.lng}" target="_blank" style="color:var(--blue);font-size:.75rem">ğŸ“</a>`:"â€”"}</td></tr>`;
  });
  c.innerHTML=`<div class="tbl-wrap"><div class="tbl-head"><h3>ğŸ“‹ ${new Date().toLocaleDateString("ar-EG",{weekday:"long",day:"numeric",month:"long"})}</h3></div><div style="overflow-x:auto"><table><thead><tr>${["Ø§Ù„Ø¹Ø§Ù…Ù„","Ø§Ù„Ù…Ø´Ø±ÙˆØ¹","Ø§Ù„Ø­Ø§Ù„Ø©","ÙˆØµÙˆÙ„","Ù…ØºØ§Ø¯Ø±Ø©","Ø³Ø§Ø¹Ø§Øª","ğŸ“"].map(h=>`<th>${h}</th>`).join("")}</tr></thead><tbody>${rows}</tbody></table></div></div>`;
}

async function rMonthly(c){
  const days=mDays();const today=getToday();
  const wtabs=CFG.workers.map(w=>`<button class="wtab ${mWorker===w.id?"active":""}" onclick="mWorker='${w.id}';renderAContent();">${esc(w.name)}</button>`).join("");
  let body="";
  if(mWorker){
    const recs=await getAllAtt(mWorker);
    let tD=0,tH=0;const pc={};let rows="";
    days.forEach(day=>{
      const r=recs[day];const isT=day===today;const isF=day>today;
      if(r?.checkIn)tD++;
      if(r?.checkIn&&r?.checkOut)tH+=(new Date(r.checkOut)-new Date(r.checkIn))/36e5;
      if(r?.projectName)pc[r.projectName]=(pc[r.projectName]||0)+1;
      rows+=`<tr style="opacity:${isF?.25:1};${isT?"background:rgba(212,168,83,.05)":""}"><td class="mono" style="font-size:.75rem;color:${isT?"var(--accent)":"var(--tm)"};font-weight:${isT?800:500}">${day}</td><td style="font-size:.75rem;color:var(--tm)">${fmtDate(day)}</td><td style="font-size:.73rem;color:var(--accent);font-weight:600">${esc(r?.projectName||"â€”")}</td><td class="mono" style="color:${r?.checkIn?"var(--g)":"#2a3d52"};font-size:.75rem">${fmtTime(r?.checkIn)}</td><td class="mono" style="color:${r?.checkOut?"var(--r)":"#2a3d52"};font-size:.75rem">${fmtTime(r?.checkOut)}</td><td style="color:var(--accent);font-weight:700;font-size:.75rem">${calcH(r?.checkIn,r?.checkOut)}</td><td>${r?.checkInLoc?`<a href="https://maps.google.com/?q=${r.checkInLoc.lat},${r.checkInLoc.lng}" target="_blank" style="color:var(--blue)">ğŸ“</a>`:`<span style="color:#2a3d52">â€”</span>`}</td><td style="font-size:.68rem;color:${r?.flag?"var(--o)":"var(--td)"}">${r?.flag?"ğŸ·ï¸ "+esc(r.flag):"â€”"}</td><td>${r&&!isF?`<button class="btn-sm" style="background:rgba(240,160,48,.12);color:var(--o)" onclick="openFlag('${mWorker}','${day}')">ğŸ·ï¸</button> <button class="btn-sm" style="background:rgba(231,76,60,.12);color:var(--r)" onclick="delRec('${mWorker}','${day}')">ğŸ—‘ï¸</button>`:""}</td></tr>`;
    });
    const pt=Object.entries(pc).map(([n,c])=>`<span style="background:rgba(212,168,83,.08);border:1px solid rgba(212,168,83,.2);border-radius:16px;padding:3px 10px;font-size:.68rem;color:var(--accent)">${esc(n)}: ${c} ÙŠÙˆÙ…</span>`).join(" ");
    body=`<div style="overflow-x:auto"><table><thead><tr>${["Ø§Ù„ØªØ§Ø±ÙŠØ®","Ø§Ù„ÙŠÙˆÙ…","Ø§Ù„Ù…Ø´Ø±ÙˆØ¹","ÙˆØµÙˆÙ„","Ù…ØºØ§Ø¯Ø±Ø©","Ø³Ø§Ø¹Ø§Øª","ğŸ“","Ù…Ù„Ø§Ø­Ø¸Ø©","Ø¥Ø¬Ø±Ø§Ø¡"].map(h=>`<th>${h}</th>`).join("")}</tr></thead><tbody>${rows}</tbody></table></div>
    <div style="text-align:center;padding:10px 18px;border-top:1px solid var(--border)"><button style="padding:8px 20px;background:rgba(52,152,219,.15);border:1px solid rgba(52,152,219,.3);border-radius:8px;color:var(--blue);font-weight:700;font-size:.8rem;cursor:pointer" onclick="printWorkerReport('${mWorker}')">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ±</button></div>
    <div style="display:flex;justify-content:center;gap:28px;padding:14px 18px;background:rgba(212,168,83,.04)">
      <div style="text-align:center"><div style="font-size:1.2rem;font-weight:900;color:var(--g)">${tD}</div><div style="font-size:.63rem;color:var(--td)">Ø£ÙŠØ§Ù…</div></div>
      <div style="text-align:center"><div style="font-size:1.2rem;font-weight:900;color:var(--accent)">${tH.toFixed(1)}</div><div style="font-size:.63rem;color:var(--td)">Ø³Ø§Ø¹Ø§Øª</div></div>
      <div style="text-align:center"><div style="font-size:1.2rem;font-weight:900;color:var(--tm)">${tD>0?(tH/tD).toFixed(1):"0"}</div><div style="font-size:.63rem;color:var(--td)">Ù…Ø¹Ø¯Ù„</div></div>
    </div>${pt?`<div style="display:flex;justify-content:center;gap:8px;flex-wrap:wrap;padding:10px 18px">${pt}</div>`:""}`;
  }
  c.innerHTML=`<div class="tbl-wrap"><div class="tbl-head"><h3>ğŸ“… ${mName()}</h3></div><div class="wtabs">${wtabs}</div>${body}</div>`;
}

function rManage(c){
  let wR=CFG.workers.map(w=>`<div class="manage-row" style="opacity:${w.active?1:.5}"><span style="flex:1;font-weight:600;font-size:.88rem;${w.active?"":"text-decoration:line-through"}">${esc(w.name)}</span><span style="color:var(--accent);font-family:monospace;font-weight:800;font-size:.85rem;direction:ltr">${w.pin}</span>${w.active?`<button class="btn-sm" style="background:rgba(39,201,110,.12);color:var(--g)" onclick="shareWhatsApp('${w.id}')">ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨</button><button class="btn-sm" style="background:rgba(52,152,219,.12);color:var(--blue)" onclick="printWorkerReport('${w.id}')">ğŸ–¨ï¸</button>`:"" }<button class="btn-sm" style="background:rgba(212,168,83,.12);color:var(--accent)" onclick="openEditPin('${w.id}')">âœï¸ PIN</button><button class="btn-sm" style="background:${w.active?"rgba(231,76,60,.12)":"rgba(39,201,110,.12)"};color:${w.active?"var(--r)":"var(--g)"}" onclick="togW('${w.id}')">${w.active?"ØªØ¹Ø·ÙŠÙ„":"ØªÙØ¹ÙŠÙ„"}</button></div>`).join("");
  let pT=CFG.projects.map(p=>`<div style="display:flex;align-items:center;gap:8px;padding:8px 14px;background:rgba(15,25,42,.6);border-radius:10px;opacity:${p.active?1:.5}"><span style="font-weight:600;font-size:.82rem;${p.active?"":"text-decoration:line-through"}">${esc(p.name)}</span><button class="btn-sm" style="background:${p.active?"rgba(231,76,60,.12)":"rgba(39,201,110,.12)"};color:${p.active?"var(--r)":"var(--g)"}" onclick="togP('${p.id}')">${p.active?"âœ•":"âœ“"}</button></div>`).join("");
  c.innerHTML=`
  <div class="manage-card"><h3>ğŸ‘· Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ø§Ù„</h3>${wR}<div style="display:flex;gap:8px;margin-top:16px"><input class="manage-input" id="nwn" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„" style="flex:1"><input class="manage-input" id="nwp" placeholder="PIN" maxlength="4" style="width:80px;direction:ltr;text-align:center"><button class="btn-add" onclick="addW()">+ Ø¥Ø¶Ø§ÙØ©</button></div>
    <button style="width:100%;margin-top:12px;padding:12px;background:rgba(39,201,110,.15);border:1px solid rgba(39,201,110,.3);border-radius:10px;color:var(--g);font-weight:700;font-size:.85rem;cursor:pointer" onclick="shareAllWhatsApp()">ğŸ“± Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button></div>
  <div class="manage-card"><h3>ğŸ—ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h3><div style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px">${pT}</div><div style="display:flex;gap:8px"><input class="manage-input" id="npn" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯" style="flex:1"><button class="btn-add" onclick="addP()">+ Ø¥Ø¶Ø§ÙØ©</button></div></div>
  <div class="manage-card"><h3>ğŸ” ØªØºÙŠÙŠØ± Ø±Ù…Ø² Ø§Ù„Ù…Ø¯ÙŠØ±</h3><div style="display:flex;gap:8px;align-items:center"><span style="color:var(--tm);font-size:.85rem">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„ÙŠ:</span><span style="color:var(--accent);font-family:monospace;font-weight:800;font-size:1rem;direction:ltr">${CFG.adminPin}</span><button class="btn-sm" style="background:rgba(212,168,83,.12);color:var(--accent);padding:6px 14px;font-size:.78rem" onclick="openEditAdmin()">âœï¸ ØªØºÙŠÙŠØ±</button></div></div>
  <div class="manage-card"><h3>ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3><p style="color:var(--td);font-size:.78rem;margin-bottom:10px">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©: <strong style="color:var(--accent)">${SITE_PASSWORD}</strong></p><p style="color:var(--td);font-size:.72rem">Ù„ØªØºÙŠÙŠØ±Ù‡Ø§: Ø¹Ø¯Ù‘Ù„ Ù‚ÙŠÙ…Ø© SITE_PASSWORD ÙÙŠ ÙƒÙˆØ¯ HTML</p></div>
  <div class="manage-card"><h3>ğŸ§ª Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</h3><p style="color:var(--td);font-size:.78rem;margin-bottom:14px">Ø¥Ø¶Ø§ÙØ© 5 Ø£ÙŠØ§Ù… ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ø£ÙˆÙ„ Ø¹Ø§Ù…Ù„</p><button style="padding:10px 20px;background:rgba(212,168,83,.15);border:1px solid rgba(212,168,83,.3);border-radius:10px;color:var(--accent);font-weight:700" onclick="genDemo()">ğŸ§ª Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button></div>`;
}

async function rArchive(c){
  const f=await getAllFlagged();
  if(!f.length){c.innerHTML=`<div class="tbl-wrap"><div class="tbl-head"><h3>ğŸ—„ï¸ Ø£Ø±Ø´ÙŠÙ</h3></div><div style="padding:30px;text-align:center;color:var(--td)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù…ÙØ¹Ù„Ù‘Ù…Ø©</div></div>`;return;}
  let rows=f.map(r=>`<tr><td class="mono" style="font-size:.75rem;color:var(--tm)">${r.date}</td><td style="font-weight:700;font-size:.82rem">${esc(r.workerName)}</td><td style="font-size:.75rem;color:var(--accent);font-weight:600">${esc(r.projectName||"â€”")}</td><td class="mono" style="color:var(--tm);font-size:.75rem">${fmtTime(r.checkIn)}</td><td class="mono" style="color:var(--tm);font-size:.75rem">${fmtTime(r.checkOut)}</td><td style="color:var(--accent);font-weight:700;font-size:.75rem">${calcH(r.checkIn,r.checkOut)}</td><td style="font-size:.75rem;color:var(--o);font-weight:600">ğŸ·ï¸ ${esc(r.flag)}</td><td><button class="btn-sm" style="background:rgba(231,76,60,.12);color:var(--r)" onclick="delRec('${r.workerId}','${r.date}')">ğŸ—‘ï¸</button></td></tr>`).join("");
  c.innerHTML=`<div class="tbl-wrap"><div class="tbl-head"><h3>ğŸ—„ï¸ Ø£Ø±Ø´ÙŠÙ</h3></div><div style="overflow-x:auto"><table><thead><tr>${["Ø§Ù„ØªØ§Ø±ÙŠØ®","Ø§Ù„Ø¹Ø§Ù…Ù„","Ø§Ù„Ù…Ø´Ø±ÙˆØ¹","ÙˆØµÙˆÙ„","Ù…ØºØ§Ø¯Ø±Ø©","Ø³Ø§Ø¹Ø§Øª","Ù…Ù„Ø§Ø­Ø¸Ø©","Ø¥Ø¬Ø±Ø§Ø¡"].map(h=>`<th>${h}</th>`).join("")}</tr></thead><tbody>${rows}</tbody></table></div></div>`;
}

// ============================================================
// ADMIN ACTIONS
// ============================================================
async function addW(){const n=document.getElementById("nwn").value.trim(),p=document.getElementById("nwp").value.trim();if(!n||!p||p.length!==4||!/^\d{4}$/.test(p))return alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ùˆ PIN (4 Ø£Ø±Ù‚Ø§Ù…)");CFG.workers.push({id:gid(),name:n,pin:p,active:true});await saveCfg();renderAContent();}
async function togW(id){CFG.workers=CFG.workers.map(w=>w.id===id?{...w,active:!w.active}:w);await saveCfg();await renderASummary();renderAContent();}
async function addP(){const n=document.getElementById("npn").value.trim();if(!n)return;CFG.projects.push({id:gid(),name:n,active:true});await saveCfg();renderAContent();}
async function togP(id){CFG.projects=CFG.projects.map(p=>p.id===id?{...p,active:!p.active}:p);await saveCfg();renderAContent();}

async function delRec(wid,date){if(!confirm("Ø­Ø°Ù Ø³Ø¬Ù„ "+date+"ØŸ"))return;await delAtt(wid,date);await renderAContent();}

async function genDemo(){
  const aw=CFG.workers.filter(w=>w.active);if(!aw.length)return;
  const w=aw[0];const projs=CFG.projects.filter(p=>p.active);
  for(let i=1;i<=5;i++){
    const d=new Date();d.setDate(d.getDate()-i);
    const ds=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
    const p=projs[i%projs.length]||projs[0];
    const ci=new Date(d);ci.setHours(7+Math.floor(Math.random()*2),Math.floor(Math.random()*60));
    const co=new Date(ci);co.setHours(ci.getHours()+8+Math.floor(Math.random()*2));
    await setAtt(w.id,ds,{workerId:w.id,workerName:w.name,date:ds,projectId:p.id,projectName:p.name,checkIn:ci.toISOString(),checkInLoc:{lat:32.08+Math.random()*.01,lng:34.78+Math.random()*.01,acc:10},checkOut:co.toISOString(),checkOutLoc:{lat:32.08+Math.random()*.01,lng:34.78+Math.random()*.01,acc:10},flag:"ØªØ¬Ø±ÙŠØ¨ÙŠ"});
  }
  alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ 5 Ø³Ø¬Ù„Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù€ "+w.name);adminLoad();
}

// ============================================================
// MODALS
// ============================================================
function closeModal(){document.getElementById("modal").style.display="none";}

function openFlag(wid,date){
  const tags=["ØªØ¬Ø±ÙŠØ¨ÙŠ","Ø¨Ø§Ù„Ø®Ø·Ø£","Ø¥Ø¬Ø§Ø²Ø©","ØªØ£Ø®ÙŠØ±","Ø¹Ù…Ù„ Ø¥Ø¶Ø§ÙÙŠ"];
  document.getElementById("modal-content").innerHTML=`
    <h3>ğŸ·ï¸ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø³Ø¬Ù„</h3>
    <div class="tag-btns">${tags.map(t=>`<button class="tag-btn" onclick="document.getElementById('fi').value='${t}';this.parentNode.querySelectorAll('.tag-btn').forEach(b=>b.classList.remove('sel'));this.classList.add('sel')">${t}</button>`).join("")}</div>
    <input class="manage-input" id="fi" placeholder="Ø£Ùˆ Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø©..." style="margin-bottom:14px">
    <div style="display:flex;gap:8px">
      <button style="flex:1;padding:12px;background:linear-gradient(135deg,var(--accent),var(--accentG));border:none;border-radius:10px;color:#0b1929;font-weight:700;cursor:pointer" onclick="saveFlag('${wid}','${date}')">ğŸ’¾ Ø­ÙØ¸</button>
      <button style="padding:12px;background:rgba(231,76,60,.15);border:none;border-radius:10px;color:var(--r);font-weight:700;cursor:pointer" onclick="rmFlag('${wid}','${date}')">Ø¥Ø²Ø§Ù„Ø©</button>
    </div>`;
  document.getElementById("modal").style.display="flex";
}
async function saveFlag(wid,date){const n=document.getElementById("fi").value.trim();const r=await getAtt(wid,date);if(!r)return;r.flag=n;await setAtt(wid,date,r);closeModal();renderAContent();}
async function rmFlag(wid,date){const r=await getAtt(wid,date);if(!r)return;r.flag=null;await setAtt(wid,date,r);closeModal();renderAContent();}

function openEditPin(wid){
  const w=CFG.workers.find(x=>x.id===wid);if(!w)return;
  document.getElementById("modal-content").innerHTML=`
    <h3>âœï¸ ØªØºÙŠÙŠØ± PIN Ù„Ù€ ${esc(w.name)}</h3>
    <p style="color:var(--td);font-size:.8rem;margin-bottom:12px">PIN Ø§Ù„Ø­Ø§Ù„ÙŠ: <strong style="color:var(--accent);font-family:monospace">${w.pin}</strong></p>
    <input class="manage-input" id="epi" placeholder="PIN Ø§Ù„Ø¬Ø¯ÙŠØ¯ (4 Ø£Ø±Ù‚Ø§Ù…)" maxlength="4" style="direction:ltr;text-align:center;font-size:1.2rem;font-weight:800;margin-bottom:14px;letter-spacing:8px" type="tel" inputmode="numeric">
    <button style="width:100%;padding:12px;background:linear-gradient(135deg,var(--accent),var(--accentG));border:none;border-radius:10px;color:#0b1929;font-weight:700;cursor:pointer;font-size:1rem" onclick="saveWPin('${wid}')">ğŸ’¾ Ø­ÙØ¸</button>`;
  document.getElementById("modal").style.display="flex";
  setTimeout(()=>document.getElementById("epi").focus(),100);
}
async function saveWPin(wid){const p=document.getElementById("epi").value.trim();if(!p||p.length!==4||!/^\d{4}$/.test(p))return alert("Ø£Ø¯Ø®Ù„ 4 Ø£Ø±Ù‚Ø§Ù…");CFG.workers=CFG.workers.map(w=>w.id===wid?{...w,pin:p}:w);await saveCfg();closeModal();renderAContent();}

function openEditAdmin(){
  document.getElementById("modal-content").innerHTML=`
    <h3>ğŸ” ØªØºÙŠÙŠØ± Ø±Ù…Ø² Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
    <p style="color:var(--td);font-size:.8rem;margin-bottom:12px">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„ÙŠ: <strong style="color:var(--accent);font-family:monospace">${CFG.adminPin}</strong></p>
    <input class="manage-input" id="eai" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¬Ø¯ÙŠØ¯ (4 Ø£Ø±Ù‚Ø§Ù…)" maxlength="4" style="direction:ltr;text-align:center;font-size:1.2rem;font-weight:800;margin-bottom:14px;letter-spacing:8px" type="tel" inputmode="numeric">
    <button style="width:100%;padding:12px;background:linear-gradient(135deg,var(--accent),var(--accentG));border:none;border-radius:10px;color:#0b1929;font-weight:700;cursor:pointer;font-size:1rem" onclick="saveAPin()">ğŸ’¾ Ø­ÙØ¸</button>`;
  document.getElementById("modal").style.display="flex";
  setTimeout(()=>document.getElementById("eai").focus(),100);
}
async function saveAPin(){const p=document.getElementById("eai").value.trim();if(!p||p.length!==4||!/^\d{4}$/.test(p))return alert("Ø£Ø¯Ø®Ù„ 4 Ø£Ø±Ù‚Ø§Ù…");CFG.adminPin=p;await saveCfg();closeModal();renderAContent();}

// ============================================================
// INIT
// ============================================================
async function init(){
  CFG=await loadCfg();
  if(!CFG){CFG=JSON.parse(JSON.stringify(DEF));await saveCfg();}
  // Check URL hash for direct worker link
  const hash=window.location.hash.replace("#","");
  if(hash&&hash!=="admin"){
    const w=CFG.workers.find(x=>x.id===hash&&x.active);
    if(w){sessionStorage.setItem("mashour_auth","1");curW=w;wAttempts=0;showPage("worker-pin");return;}
  }
  if(sessionStorage.getItem("mashour_auth")==="1")showPage("home");
}
// Override checkSitePass to save session
const _origCheck=checkSitePass;
window.checkSitePass=function(){
  const v=document.getElementById("site-pass").value;
  if(v===SITE_PASSWORD){sessionStorage.setItem("mashour_auth","1");showPage("home");}
  else{const e=document.getElementById("site-pass-err");e.textContent="âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";e.style.display="block";document.getElementById("site-pass").value="";}
};

// ============================================================
// WHATSAPP SHARE LINKS
// ============================================================
function getWorkerLink(wid){
  const base=window.location.origin+window.location.pathname;
  return base+"#"+wid;
}

function shareWhatsApp(wid){
  const w=CFG.workers.find(x=>x.id===wid);if(!w)return;
  const link=getWorkerLink(wid);
  const msg=encodeURIComponent(`Ù…Ø±Ø­Ø¨Ø§ ${w.name} ğŸ‘‹\nØ±Ø§Ø¨Ø· ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ:\n${link}\n\nÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${SITE_PASSWORD}\nØ§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ: ${w.pin}\n\nØ³Ø¬Ù‘Ù„ ÙˆØµÙˆÙ„Ùƒ ÙƒÙ„ ØµØ¨Ø§Ø­ ÙˆÙ…ØºØ§Ø¯Ø±ØªÙƒ Ø¢Ø®Ø± Ø§Ù„ÙŠÙˆÙ… âœ…`);
  window.open("https://wa.me/?text="+msg,"_blank");
}

function shareAllWhatsApp(){
  const aw=CFG.workers.filter(w=>w.active);
  let msg="Ø±ÙˆØ§Ø¨Ø· ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù„Ø¹Ù…Ø§Ù„ ğŸ‘·\n\nÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹: "+SITE_PASSWORD+"\n\n";
  aw.forEach(w=>{msg+=w.name+": "+getWorkerLink(w.id)+" (PIN: "+w.pin+")\n";});
  msg+="\nÙƒÙ„ Ø¹Ø§Ù…Ù„ ÙŠÙØªØ­ Ø±Ø§Ø¨Ø·Ù‡ ÙˆÙŠØ³Ø¬Ù‘Ù„ ÙˆØµÙˆÙ„/Ù…ØºØ§Ø¯Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹ âœ…";
  window.open("https://wa.me/?text="+encodeURIComponent(msg),"_blank");
}

// ============================================================
// PRINT REPORT
// ============================================================
async function printWorkerReport(wid){
  const w=CFG.workers.find(x=>x.id===wid);if(!w)return;
  const recs=await getAllAtt(wid);
  const days=mDays();const today=getToday();
  let tD=0,tH=0;
  let rows="";
  days.forEach(day=>{
    if(day>today)return;
    const r=recs[day];
    if(r?.checkIn)tD++;
    if(r?.checkIn&&r?.checkOut)tH+=(new Date(r.checkOut)-new Date(r.checkIn))/36e5;
    rows+=`<tr><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px">${day}</td><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px">${fmtDate(day)}</td><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px">${r?.projectName||"â€”"}</td><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px">${fmtTime(r?.checkIn)}</td><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px">${fmtTime(r?.checkOut)}</td><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px">${calcH(r?.checkIn,r?.checkOut)}</td><td style="padding:6px 10px;border:1px solid #ddd;font-size:12px;color:#e67e22">${r?.flag||""}</td></tr>`;
  });
  const pw=window.open("","_blank");
  pw.document.write(\`<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8"><title>ØªÙ‚Ø±ÙŠØ± \${w.name}</title></head><body style="font-family:Arial,sans-serif;padding:30px;max-width:800px;margin:0 auto">
    <div style="text-align:center;margin-bottom:20px"><h2 style="color:#1a3a5c;margin:0">Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</h2><p style="color:#888;font-size:14px">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ - \${mName()}</p></div>
    <div style="background:#f5f5f5;padding:15px;border-radius:8px;margin-bottom:20px;display:flex;justify-content:space-between">
      <div><strong>Ø§Ù„Ø¹Ø§Ù…Ù„:</strong> \${w.name}</div>
      <div><strong>Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±:</strong> \${tD}</div>
      <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª:</strong> \${tH.toFixed(1)}</div>
      <div><strong>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ:</strong> \${tD>0?(tH/tD).toFixed(1):"0"}</div>
    </div>
    <table style="width:100%;border-collapse:collapse"><thead><tr style="background:#1a3a5c;color:#fff">\${["Ø§Ù„ØªØ§Ø±ÙŠØ®","Ø§Ù„ÙŠÙˆÙ…","Ø§Ù„Ù…Ø´Ø±ÙˆØ¹","ÙˆØµÙˆÙ„","Ù…ØºØ§Ø¯Ø±Ø©","Ø³Ø§Ø¹Ø§Øª","Ù…Ù„Ø§Ø­Ø¸Ø©"].map(h=>"<th style='padding:8px 10px;font-size:12px'>"+h+"</th>").join("")}</tr></thead><tbody>\${rows}</tbody></table>
    <div style="margin-top:20px;text-align:center;color:#888;font-size:12px">Ø·ÙØ¨Ø¹ Ø¨ØªØ§Ø±ÙŠØ® \${new Date().toLocaleDateString("ar-EG")} Â· Ù…Ø´Ù‡ÙˆØ± Ù„Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù‡Ù†Ø¯Ø³Ø©</div>
    <script>setTimeout(()=>window.print(),500)<\/script>
  </body></html>\`);
}

init();
</script>
</body>
</html>
